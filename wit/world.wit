package near:rpc@0.1.0;

interface api {
    // ==================== Query Methods (view functions) ====================

    /// Call a view function on a smart contract
    /// finality-or-block: "final", "optimistic", block height (e.g. "12345"), or block hash
    /// Empty string = "final" (default)
    view: func(contract-id: string, method-name: string, args-json: string, finality-or-block: string) -> tuple<string, string>;

    /// Get account information (balance, storage, code hash)
    /// finality-or-block: "final", "optimistic", block height, or block hash (empty = "final")
    view-account: func(account-id: string, finality-or-block: string) -> tuple<string, string>;

    /// Get access key information (nonce, permission, block hash)
    /// finality-or-block: "final", "optimistic", block height, or block hash (empty = "final")
    view-access-key: func(account-id: string, public-key: string, finality-or-block: string) -> tuple<string, string>;

    /// Get all access keys for an account
    /// finality-or-block: "final", "optimistic", block height, or block hash (empty = "final")
    view-access-key-list: func(account-id: string, finality-or-block: string) -> tuple<string, string>;

    /// Get contract WASM code
    /// finality-or-block: "final", "optimistic", block height, or block hash (empty = "final")
    view-code: func(account-id: string, finality-or-block: string) -> tuple<string, string>;

    /// Get contract state (all keys with prefix)
    /// prefix-base64: prefix in base64 (empty string = all keys)
    /// finality-or-block: "final", "optimistic", block height, or block hash (empty = "final")
    view-state: func(account-id: string, prefix-base64: string, finality-or-block: string) -> tuple<string, string>;

    // ==================== Block Methods ====================

    /// Get block information
    /// finality-or-block: "final", "optimistic", block height (e.g. "12345"), or block hash
    block: func(finality-or-block: string) -> tuple<string, string>;

    /// Get chunk information
    /// chunk-id-or-block-shard: chunk ID OR "block_id,shard_id" (e.g. "12345,0")
    chunk: func(chunk-id-or-block-shard: string) -> tuple<string, string>;

    /// Get changes in a block
    /// finality-or-block: "final", "optimistic", block height, or block hash
    changes: func(finality-or-block: string) -> tuple<string, string>;

    // ==================== Transaction Methods ====================

    /// Send a signed transaction
    /// wait-until: "NONE", "INCLUDED", "EXECUTED_OPTIMISTIC" (default), "INCLUDED_FINAL", "EXECUTED", "FINAL"
    /// Empty string = "EXECUTED_OPTIMISTIC"
    send-tx: func(signed-tx-base64: string, wait-until: string) -> tuple<string, string>;

    /// Get transaction status by hash
    /// wait-until: same as send-tx (empty = "EXECUTED_OPTIMISTIC")
    tx-status: func(tx-hash: string, sender-account-id: string, wait-until: string) -> tuple<string, string>;

    /// Get receipt by ID
    receipt: func(receipt-id: string) -> tuple<string, string>;

    /// Call a contract method with explicit signer (WASM provides private key)
    /// CRITICAL: Worker NEVER signs with its own key. WASM MUST provide signer credentials.
    /// signer-id: the account to sign as
    /// signer-key: the private key in NEAR format (ed25519:base58...)
    /// wait-until: same as send-tx (empty = "FINAL")
    /// Returns (tx_hash, error)
    call: func(signer-id: string, signer-key: string, receiver-id: string, method-name: string, args-json: string, deposit-yocto: string, gas: string, wait-until: string) -> tuple<string, string>;

    /// Transfer NEAR tokens with explicit signer (WASM provides private key)
    /// CRITICAL: Worker NEVER signs with its own key. WASM MUST provide signer credentials.
    /// signer-id: the account to sign as
    /// signer-key: the private key in NEAR format (ed25519:base58...)
    /// wait-until: same as send-tx (empty = "FINAL")
    /// Returns (tx_hash, error)
    transfer: func(signer-id: string, signer-key: string, receiver-id: string, amount-yocto: string, wait-until: string) -> tuple<string, string>;

    // ==================== Network Methods ====================

    /// Get current gas price
    /// block-id: block height or hash (empty = latest)
    gas-price: func(block-id: string) -> tuple<string, string>;

    /// Get node status (sync status, version, protocol)
    status: func() -> tuple<string, string>;

    /// Get network info (peers, connections)
    network-info: func() -> tuple<string, string>;

    /// Get validators for epoch
    /// epoch-id: specific epoch ID or empty for current validators
    validators: func(epoch-id: string) -> tuple<string, string>;

    // ==================== Low-level API ====================

    /// Raw JSON-RPC call (for any method not covered above)
    raw: func(method: string, params-json: string) -> tuple<string, string>;
}

world bot-father {
    import api;
}
